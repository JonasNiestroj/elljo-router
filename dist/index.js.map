{"version":3,"file":"index.js","sources":["../node_modules/@elljo/runtime/src/lifecycleHooks.js","../node_modules/@elljo/runtime/src/elljoComponent.js","../src/utils/id.js","../src/components/router.jo","../src/router/router.js"],"sourcesContent":["export let currentComponent = null;\n\nexport const setComponent = (component) => {\n  currentComponent = component\n}\n\nexport const afterRender = (callback) => {\n  if (!currentComponent) {\n    return\n  }\n  currentComponent.$.afterRender.push(callback)\n}\n\nexport const beforeDestroy = (callback) => {\n  if (!currentComponent) {\n    return\n  }\n  currentComponent.$.beforeDestroy.push(callback)\n}\n\nexport const mounted = (callback) => {\n  if (!currentComponent) {\n    return\n  }\n  currentComponent.$.mounted.push(callback)\n}\n\nexport const update = (callback) => {\n  if (!currentComponent) {\n    return\n  }\n  currentComponent.$.update.push(callback)\n}","import { setComponent, currentComponent } from './lifecycleHooks';\nimport Observer from './observer';\n\nexport default class EllJoComponent {\n  constructor(options, props, events) {\n    this.$ = {};\n    this.$.afterRender = [];\n    this.$.beforeDestroy = [];\n    this.$.mounted = [];\n    this.$.update = [];\n    this.$props = {};\n    this.$events = {};\n    this.oldState = {};\n    this.updating = false;\n    setComponent(this);\n\n    if (events) {\n      Object.keys(events).forEach((event) => {\n        if (!this.$events[event]) {\n          this.$events[event] = [events[event]];\n        } else {\n          this.$events[event].push(events[event]);\n        }\n      });\n    }\n\n    this.$event = (name) => {\n      var callbacks = this.$events[name];\n      if (callbacks) {\n        const args = [];\n        for (let i = 1; i < arguments.length; i++) {\n          args.push(arguments[i]);\n        }\n        callbacks.forEach((callback) => callback(...args));\n      }\n    };\n\n    this.utils = {\n      diffArray: function diffArray(one, two) {\n        if (!Array.isArray(two)) {\n          return one.slice();\n        }\n\n        var tlen = two.length;\n        var olen = one.length;\n        var idx = -1;\n        var arr = [];\n\n        while (++idx < olen) {\n          var ele = one[idx];\n\n          var hasEle = false;\n          for (var i = 0; i < tlen; i++) {\n            var val = two[i];\n\n            if (ele === val) {\n              hasEle = true;\n              break;\n            }\n          }\n\n          if (hasEle === false) {\n            arr.push({ element: ele, index: idx });\n          }\n        }\n        return arr;\n      },\n    };\n  }\n\n  updateValue(name, func) {\n    currentComponent[name + 'IsDirty'] = true;\n    currentComponent.queueUpdate();\n  }\n\n  update() {\n    const callbacks = this.$.update;\n    for (let i = 0; i < callbacks.length; i++) {\n      callbacks[i]();\n    }\n    this.updating = false;\n    this.$.mainFragment.update();\n    this.oldState = {};\n  }\n\n  queueUpdate() {\n    if (!this.updating) {\n      this.updating = true;\n      Promise.resolve().then(() => this.update());\n    }\n  }\n\n  teardown() {\n    const callbacks = this.$.beforeDestroy;\n    for (let i = 0; i < callbacks.length; i++) {\n      callbacks[i]();\n    }\n    this.$.mainFragment.teardown();\n    this.$.mainFragment = null;\n  }\n}\n","const CHARACTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';\nconst CHARACTERS_LENGTH = CHARACTERS.length;\n\nconst generateId = (length) => {\n  var result = '';\n  for (let i = 0; i < length; i++) {\n    result += CHARACTERS.charAt(Math.floor(Math.random() * CHARACTERS_LENGTH));\n  }\n  return result;\n};\n\nexport default generateId;\n","<div :id=\"id\"></div>\n\n<script>\nimport { afterRender } from '@elljo/runtime'\nimport generateId from '../utils/id'\n\nconst router = window.__elljo_router__\n\nif(!router) {\n  // TODO: Add better error\n  console.error(\"no router\")\n}\nconst id = generateId(4)\n\nlet currentRoute = null\n\nconst routeChanged = (route) => {\n  if(currentRoute && currentRoute !== route) {\n    currentRoute.teardown()\n  }\n  if(route) {\n    currentRoute = route\n    window.__elljo__.mount(route.component, '#' + id)\n  }\n}\n\nrouter.addRouteChangedCallback(routeChanged)\n\nconst initRoute = () => {\n  routeChanged(router.getRouteFromPath(document.location.pathname))\n}\n\nafterRender(initRoute)\n\n</script>","import RouterComponent from '../components/router.jo'\n\nexport let currentRoute = null\n\nexport default function Router(routes) {\n\n  const routeChangedCallbacks = []\n\n  this.addRouteChangedCallback = (callback) => {\n    routeChangedCallbacks.push(callback)\n  }\n\n  this.getRouteFromPath = (path) => {\n    for (let route of routes) {\n      if (route.url === path) {\n        return route\n      }\n    }\n    return null\n  }\n  \n  window.addEventListener('popstate', () => {\n    this.routeChangedCallbacks.forEach(callback => {\n      let newRoute = this.getRouteFromPath(document.location.pathname)\n      currentRoute = newRoute\n      callback(newRoute)\n    })\n  })\n\n  let newRoute = this.getRouteFromPath(document.location.pathname)\n  currentRoute = newRoute\n  \n  window.__elljo_router__ = this\n}\n\nRouter.prototype.init = (elljo) => {\n  elljo.addComponent('Router', RouterComponent)\n}"],"names":["RouterComponent"],"mappings":"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"}